<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>

    <title>Institutions</title>

    <link href="/assets/bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/assets/css/styles.css" rel="stylesheet" />
    <script src="/assets/jquery-3.1.0.min.js"></script>
    <script src="/assets/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
	<!--<link href="../static/assets/bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../static/assets/css/styles.css" rel="stylesheet" />
    <script src="../static/assets/jquery-3.1.0.min.js"></script>
    <script src="../static/assets/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>-->
	<script th:inline="javascript">
		/*<![CDATA[*/
        var institutionId = [[${institution.id}]];
        var userFullName = [[${user.fullName}]];
        var csrfName = [[${_csrf.parameterName}]];
        var csrfValue = [[${_csrf.token}]];
		jQuery(document).ready(function() {
            $('#select-doctor-tickets').on('change', function() {
                var doctorId = jQuery('#select-doctor-tickets').val();
                var trs = jQuery('#table-tickets tbody tr');
                trs.show();
                if (doctorId > 0) {
                    trs.not('.ticket-for-doctor-' + doctorId).hide();
                }
            })
            $('#removeTicketsModal').on('hidden.bs.modal', function () {
                var el = jQuery("#removeTicketsModal");
                el.find("input[name=removeTicketDate]").val("");
                el.find("#success-remove-tickets").hide();
                el.find("#error-remove-tickets").hide();
            })
            $('#addTicketsModal').on('hidden.bs.modal', function () {
                var el = jQuery("#addTicketsModal");
                el.find("input[name=startDate]").val("");
                el.find("input[name=endDate]").val("");
                el.find("input[name=interval]").val("");
                el.find("#success-add-tickets").hide();
                el.find("#error-add-tickets").hide();
                el.find("#error-add-tickets-empty").hide();
            })
            $('#setVisitedModal').on('hidden.bs.modal', function () {
                var el = jQuery("#setVisitedModal");
                el.find("input[name=summary-text]").val("");
                el.find("#success-summary").hide();
                el.find("#error-summary").hide();
                el.find("a.btn-sm").show();
            })
            $('#doctorModal').on('hidden.bs.modal', function () {
                var el = jQuery("#doctorModal");
                el.find("input").val("");
                el.find("#success-add-doctor, #error-add-doctor-invalid, #error-add-doctor").hide();
            })
		});
		function addEducationalRequest() {
            jQuery("#error-request").hide();
            jQuery("#success-request").hide();
            $.ajax({
                type: "GET",
                url: "/citizen/add_request",
                data: {
                    "institutionId": institutionId,
                    "childId": $('#request-child').val(),
                    "classNumber": $('#request-class').val()
                },
                timeout: 100000,
                success: function (data) {
                    jQuery("#error-request").hide();
                    jQuery("#success-request").show();
                },
                error: function () {
                    jQuery("#error-request").show();
                }
            });
		}
        var reqId = 0;
		var btnAppointment;
        function saveRequestId(elem) {
            btnAppointment = jQuery(elem);
            reqId = jQuery(elem).parent().find("input[name=id]").val();
        }
        function makeAppointment(el) {
            var appointment = $('input[name=appointment-date]').val();
            jQuery("#error-appointment").hide();
            jQuery("#success-appointment").hide();
            $.ajax({
                type: "GET",
                url: "/edur/make_appointment",
                data: {
                    "request_id": reqId,
                    "date": appointment
                },
                timeout: 100000,
                success: function () {
                    jQuery("#error-appointment").hide();
                    $("#table-requests tbody").find('tr#el-request-' + reqId + ' td:eq(1)').html(appointment);
                    jQuery("#success-appointment").show();
                    btnAppointment.remove();
                    jQuery(el).hide();
                },
                error: function () {
                    jQuery("#error-appointment").show();
                }
            });
        }
        function modalAppointmentClean() {
            var el = jQuery("#appointmentModal");
            el.find("input[name=appointment-date]").val("");
            el.find("#success-appointment").hide();
            el.find("#error-appointment").hide();
            el.find("a.btn-sm").show();
        }
		function saveFeedback() {
            var text = $('input[name=new-feedback-text]').val();
            jQuery("#error-feedback").hide();
            jQuery("#success-feedback").hide();
            $.ajax({
                type: "GET",
                url: "/add_feedback",
                data: {
                    "institutionId": institutionId,
                    "text": text,
                    "toUserId": toUserId
                },
                timeout: 100000,
                success: function (data) {
                    jQuery("#error-feedback").hide();
                    var markup = '<tr><td class="col-xs-1">now</td><td class="col-xs-2">' + userFullName + '</td><td class="col-xs-2">' + toUserName + '</td><td class="col-xs-6">' + text + '</td><td></td></tr>';
                    $("#table-feedbacks tbody").prepend(markup);
                    jQuery("#success-feedback").show();
                },
                error: function () {
                    jQuery("#error-feedback").show();
                }
            });
		}
        function saveInformation() {
		    var form = jQuery("#institution-info-form");
            var title = form.find("input[name=title]").val();
            var city = form.find("input[name=city]").val();
            var district = form.find("input[name=district]").val();
            var address = form.find("input[name=address]").val();
            var telephone = form.find("input[name=telephone]").val();
            var fax = form.find("input[name=fax]").val();
            jQuery("#error-info").hide();
            jQuery("#success-info").hide();
            if (title.length > 0 && city.length > 0 && district.length > 0 && address.length > 0 && telephone.length > 0 && fax.length > 0) {
                jQuery("#error-info-empty").hide();
                var form = {
                    "title": title,
                    "city": city,
                    "district": district,
                    "address": address,
                    "telephone": telephone,
                    "fax": fax,
					"institutionId": institutionId
                };
                form[csrfName] = csrfValue;
                $.ajax({
                    type: "POST",
                    contentType: 'application/x-www-form-urlencoded;',
                    url: "/save_institution_info",
                    data: form,
                    timeout: 100000,
                    success: function () {
                        jQuery("#success-info").show();
                    },
                    error: function () {
                        jQuery("#error-info").show();
                    }
                });
            }
            else {
                jQuery("#error-info-empty").show();
            }
        }

        var doctorId = 0;
        function saveDoctorId(el) {
            doctorId = jQuery(el).parent().find('input[name=id]').val();
		}
        function modalAddTicketsClean() {
            console.log("here!!");
            var el = jQuery("#addTicketsModal");
            el.find("input[name=startDate]").val("");
            el.find("input[name=endDate]").val("");
            el.find("input[name=interval]").val("");
            el.find("#success-add-tickets").hide();
            el.find("#error-add-tickets").hide();
            el.find("#error-add-tickets-empty").hide();
        }
        function modalAddTicketClean() {
            var el = jQuery("#addTicketModal");
            el.find("input[name=ticketDate]").val("");
            el.find("#success-add-ticket").hide();
            el.find("#success-add-ticket").hide();
            el.find("#success-add-ticket-empty").hide();
        }
        function addTickets() {
            var startDate = $('input[name=startDate]').val();
            var endDate = $('input[name=endDate]').val();
            var interval = $('input[name=interval]').val();
            jQuery("#error-add-tickets").hide();
            jQuery("#success-add-tickets").hide();
			if (startDate.length > 0 && endDate.length > 0 && interval.length > 0) {
                jQuery("#error-add-tickets-empty").hide();
                $.ajax({
                    type: "GET",
                    url: "/medr/add_tickets",
                    data: {
                        "startDate": startDate,
                        "endDate": endDate,
                        "interval": interval,
                        "doctorId": doctorId
                    },
                    timeout: 100000,
                    success: function () {
                        jQuery("#success-add-tickets").show();
                    },
                    error: function () {
                        jQuery("#error-add-tickets").show();
                    }
                });
            }
            else {
                jQuery("#error-add-tickets-empty").show();
			}
        }
        function addTicket() {
            var date = $('input[name=ticketDate]').val();
            jQuery("#error-add-ticket").hide();
            jQuery("#success-add-ticket").hide();
            if (date.length > 0) {
                jQuery("#error-add-ticket-empty").hide();
                $.ajax({
                    type: "GET",
                    url: "/medr/add_ticket",
                    data: {
                        "date": date,
                        "doctorId": doctorId
                    },
                    timeout: 100000,
                    success: function () {
                        jQuery("#success-add-ticket").show();
                    },
                    error: function () {
                        jQuery("#error-add-ticket").show();
                    }
                });
            }
            else {
                jQuery("#error-add-ticket-empty").show();
            }
        }

		var toUserId = 0;
        var toUserName = 0;
		function saveToUserId(el) {
			toUserId = 0;
            toUserName = "";
			var idEl = jQuery(el).parent().find('input[name=toUserId]');
			if (idEl.length) {
				toUserId = idEl.val() > 0 ? idEl.val() : 0;
                toUserName = jQuery(el).parent().find('input[name=toUserName]').val();
			}
		}
        function modalFeedbackClean() {
		    var el = jQuery("#feedbackModal");
            el.find("input[name=new-feedback-text]").val("");
		    el.find("#success-feedback").hide();
            el.find("#error-feedback").hide();
		}
		function saveSeatsInfo() {
		    var form =jQuery("#form-add-seats");
            var classNumber = form.find("input[name=classNumber]").val();
            var totalSeats = form.find("input[name=totalSeats]").val();
            var busySeats = form.find("input[name=busySeats]").val();

            jQuery("#error-seats").hide();
            jQuery("#success-seats").hide();
            if (classNumber.length > 0 && totalSeats.length > 0 && busySeats.length > 0) {
                jQuery("#error-seats-empty").hide();
                var form = {
                    "classNumber": classNumber,
                    "totalSeats": totalSeats,
                    "busySeats": busySeats,
					csrfName: csrfValue,
                    "institutionId": institutionId
                };
                form[csrfName] = csrfValue;
                $.ajax({
                    type: "POST",
                    contentType: 'application/x-www-form-urlencoded;',
                    url: "/edur/add_seats_info",
                    data: form,
                    timeout: 100000,
                    success: function (data) {
                        var tbody = $("#table-seats tbody");
                        tbody.find('#el-class-number-' + classNumber).remove();
                        var markup = '<tr id="el-class-number-' + classNumber + '"><td class="col-xs-3">' + classNumber + '</td><td class="col-xs-4">' + totalSeats + '</td><td class="col-xs-4">' + (totalSeats - busySeats) + '</td></tr>';;
                        tbody.prepend(markup);
                        jQuery("#success-seats").show();
                    },
                    error: function () {
                        jQuery("#error-seats").show();
                    }
                });
            }
            else {
                jQuery("#error-seats-empty").show();
			}
        }
        function acceptRequest(elem) {
            $.ajax({
                type : "GET",
                url : "/edur/accept_request_repr",
                data: {
                    "request_id": jQuery(elem).parent().find("input[name=id]").val()
                },
                timeout : 100000,
                success : function() {
                    jQuery(elem).parent().parent().find("td:eq(2)").html("ACCEPTED BY INSTITUTION");
                    jQuery(elem).remove();
                },
                error : function() {
                    var errorElem = '<div class="alert alert-danger alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>Error occurred. Please, refresh page and try later.</div>';
                    jQuery(elem).parent().parent().find("td:eq(5)").append(errorElem);
                }
            });
        }
        function refuseRequest(elem) {
            $.ajax({
                type : "GET",
                url : "/edur/refuse_request",
                data: {
                    "request_id": jQuery(elem).parent().find("input[name=id]").val()
                },
                timeout : 100000,
                success : function() {
                    jQuery(elem).parent().parent().find("td:eq(2)").html("REFUSED");
                    jQuery(elem).parent().find("a").remove();
                },
                error : function() {
                    var errorElem = '<div class="alert alert-danger alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>Error occurred. Please, refresh page and try later.</div>';
                    jQuery(elem).parent().parent().find("td:eq(5)").append(errorElem);
                }
            });
        }
        function enrollRequest(elem) {
            $.ajax({
                type : "GET",
                url : "/edur/enroll_request",
                data: {
                    "request_id": jQuery(elem).parent().find("input[name=id]").val()
                },
                timeout : 100000,
                success : function() {
                    jQuery(elem).parent().parent().find("td:eq(2)").html("CHILD_IS_ENROLLED");
                    jQuery(elem).parent().find("a").remove();
                },
                error : function() {
                    var errorElem = '<div class="alert alert-danger alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>Error occurred.  May be no free seats! Please, refresh page and try later.</div>';
                    jQuery(elem).parent().parent().find("td:eq(5)").append(errorElem);
                }
            });
        }
        function refuseTicket(elem) {
		    var ticketId = jQuery(elem).parent().find("input[name=id]").val();
            $.ajax({
                type : "GET",
                url : "/citizen/refuse_ticket",
                data: {
                    "ticket_id": ticketId
                },
                timeout : 100000,
                success : function() {
                    jQuery('#table-tickets tbody tr#el-ticket-' + ticketId).find("td:eq(2)").html("");
                    jQuery('#table-tickets tbody tr#el-ticket-' + ticketId).find("td:eq(3)").html("");
                    jQuery(elem).parent().find("#btn-refuse").remove();
                },
                error : function() {
                    var errorElem = '<div class="alert alert-danger alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>Error occurred. Please, refresh page and try later.</div>';
                    jQuery(elem).parent().parent().find("td:eq(5)").append(errorElem);
                }
            });
        }
        var ticketId = 0;
        function saveTicketId(el)
        {
            jQuery('#success-take-ticket').hide();
            jQuery('#error-take-ticket').hide();
            jQuery("#takeTicketModal").find("a.btn-sm").show();
            ticketId = jQuery(el).parent().find('input[name=id]').val();
            console.log("ticketId save: " + ticketId);
        }
        function saveSetVisited() {
            var row = jQuery('#table-tickets tbody tr#el-ticket-' + ticketId);
            var summary = jQuery("#setVisitedModal input[name=summary-text]").val();
            $.ajax({
                type : "GET",
                url : "/medr/set_ticket_visited",
                data: {
                    "ticket_id": ticketId,
                    "summary": summary
                },
                timeout : 100000,
                success : function() {
                    row.find("td:eq(4)").html('yes');
					row.find("td:eq(5)").html(summary);
                    row.find("#btn-set-visited").remove();
                    jQuery("#setVisitedModal").find("a.btn-sm").hide();
                    jQuery('#success-summary').show();
                },
                error : function() {
                    jQuery('#error-summary').show();
                }
            });
        }
        function takeTicket(elem) {
            if (ticketId == 0) {
                var ticket_id = jQuery(elem).parent().find("input[name=id]").val();
                takeTicketAjax(ticket_id, jQuery("#takeTicketModal #take-ticket-child").val());
            }
            else {
                takeTicketAjax(ticketId, jQuery("#takeTicketModal #take-ticket-child").val());
			}
        }
        function takeTicketAjax(ticket_id, child_id) {
            var row = jQuery('#table-tickets tbody tr').find('#el-ticket-' + ticketId);
            $.ajax({
                type : "GET",
                url : "/citizen/take_ticket",
                data: {
                    "ticket_id": ticket_id,
                    "child_id": child_id
                },
                timeout : 100000,
                success : function() {
                    row.find("td:eq(2)").html(userFullName);
                    if (child_id > 0)
                    	row.find("td:eq(3)").html($( "#takeTicketModal #take-ticket-child option:selected" ).text());
                    row.find("#btn-take").remove();
                    jQuery("#takeTicketModal").find("a.btn-sm").hide();
                    jQuery('#success-take-ticket').show();
                },
                error : function() {
                    jQuery('#error-take-ticket').show();
                }
            });
		}
        function removeTickets() {
            jQuery('#success-remove-tickets').hide();
            jQuery('#error-remove-tickets').hide();
            var doctorId = jQuery("#removeTicketsModal #removeTicketsDoctor").val();
            var date = jQuery("#removeTicketsModal #removeTicketDate").val();
            $.ajax({
                type : "GET",
                url : "/medr/remove_tickets",
                data: {
                    "doctorId": doctorId,
                    "date": date
                },
                timeout : 100000,
                success : function() {
                    jQuery('#success-remove-tickets').show();
                    setTimeout(function() {}, 5000);
                    if (date.length > 0) {
                        jQuery('.ticket-for-doctor-' + doctorId + '.ticket-for-date-' + date).remove();
                    }
                    else {
                        jQuery('.ticket-for-doctor-' + doctorId).remove();
					}
                    //location.reload();
                },
                error : function() {
                    jQuery('#error-remove-tickets').show();
                }
            });
        }
		function removeTicket(el) {
            $.ajax({
                type : "GET",
                url : "/medr/remove_ticket",
                data: {
                    "ticket_id": jQuery(el).parent().find("input[name=id]").val()
                },
                timeout : 100000,
                success : function() {
                    jQuery(el).parent().parent().remove();
                },
                error : function() {
                    var errorElem = '<div class="alert alert-danger alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>Error occured. Please, refresh page and try later.</div>';
                    jQuery(el).parent().parent().find("td:eq(5)").append(errorElem);
                }
            });
		}
        function removeDoctor(el) {
            var doctorId = jQuery(el).parent().find("input[name=id]").val();
            $.ajax({
                type : "GET",
                url : "/medr/remove_doctor",
                data: {
                    "doctorId": doctorId
                },
                timeout : 100000,
                success : function() {
                    jQuery(el).parent().parent().remove();
                    jQuery('#table-tickets tbody tr.ticket-for-doctor-' + doctorId).remove();
                    var selectDoctorTicketsId = jQuery('#select-doctor-tickets').val();
                    if (selectDoctorTicketsId == doctorId) {
                        jQuery('#select-doctor-tickets').val(0);
                        jQuery('#select-doctor-tickets').change();
					}
                    jQuery('#select-doctor-tickets option[value=' + doctorId + ']').remove();
                },
                error : function() {
                    var errorElem = '<div class="alert alert-danger alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>Error occured. Please, refresh page and try later.</div>';
                    jQuery(el).parent().parent().find("td:eq(3)").append(errorElem);
                }
            });
        }
        function addDoctor() {
            var el = $('#doctorModal');
            var username = el.find('input[name=username]').val();
            var password = el.find('input[name=password]').val();
            var passwordConfirm = el.find('input[name=passwordConfirm]').val();
            var fullName = el.find('input[name=fullName]').val();
            var email = el.find('input[name=email]').val();
            var position = el.find('input[name=position]').val();
            var summary = el.find('input[name=summary]').val();

            jQuery("#success-add-doctor").hide();
            jQuery("#error-add-doctor").hide();
            if (username.length > 0 && password.length > 0 && passwordConfirm.length > 0 && password == passwordConfirm && fullName.length > 0 && email.length > 0 && position.length > 0 && summary.length > 0) {
                jQuery("#error-add-doctor-invalid").hide();
                var form = {
                    "username": username,
                    "password": password,
                    "fullName": fullName,
                    "email": email,
                    "position": position,
                    "summary": summary,
                    csrfName: csrfValue
                };
                form[csrfName] = csrfValue;
                $.ajax({
                    type: "POST",
                    contentType: 'application/x-www-form-urlencoded;',
                    url: "/medr/add_doctor",
                    data: form,
                    timeout: 100000,
                    success: function (data) {
                        $("#success-add-doctor").show();
                        var markup = '<tr><td class="col-xs-3">' + fullName + '</td><td class="col-xs-2">' + email + '</td><td class="col-xs-3">' + position + '</td><td class="col-xs-3">' + summary + '</td><td>'
                            + '<a class="btn btn-sm btn-primary" onclick="removeDoctor(this);"><span class="glyphicon glyphicon-remove"></span></a>'
                            + '<a class="btn btn-sm btn-primary" data-toggle="modal" data-target="#addTicketsModal" onclick="saveDoctorId(this);">Add tickets</a>'
                        	+ '<a class="btn btn-sm btn-primary" data-toggle="modal" data-target="#addTicketModal" onclick="saveDoctorId(this);">Add ticket</a>'
                        	+ '<input name="id" type="hidden" value="' + data + '" /></td></tr>';
						$("#table-doctors tbody").prepend(markup);
                    },
                    error: function () {
                        $("#error-add-doctor").show();
                    }
                });
            }
            else {
                $("#error-add-doctor-invalid").show();
            }
        }
		/*]]>*/
	</script>
</head>
<body>
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    	<div class="navbar-header">
      		<a class="navbar-brand" href="#">Portal of state services</a>
    	</div>
	  	<th:block th:if="${user.isCitizen()}">
			<ul class="nav navbar-nav">
			  <li><a href="/profile">Profile</a></li>
			  <li class="active"><a href="/institutions">Institutions</a></li>
			  <li><a href="/tickets">Tickets</a></li>
			  <li><a href="/childs">Childs</a></li>
			  <li><a href="/requests">Educational requests</a></li>
			</ul>
	  	</th:block>
	  	<ul class="nav navbar-nav navbar-right">
			<li><a onclick="document.forms['logoutForm'].submit()" class="btn"><span class="glyphicon glyphicon-log-out"></span>&nbsp;Logout</a></li>
	  	</ul>
	  	<form id="logoutForm" method="POST" action="/logout" style="display:none">
		  	<input type="hidden" th:attr="name=${_csrf.parameterName},value=${_csrf.token}"/>
	  	</form>
  </div>
</nav>
<div class="container">
	<ul class="nav nav-tabs">
		<li class="active"><a data-toggle="tab" href="#container-information">Infornmation</a></li>
		<th:block th:unless="${isEdu}">
		<li><a data-toggle="tab" href="#container-doctors">Doctors</a></li>
		<li><a data-toggle="tab" href="#container-tickets">Tickets</a></li>
		</th:block>
		<th:block th:if="${isEdu}" th:unless="${user.isCitizen()}">
		<li><a data-toggle="tab" href="#container-requests">Educational requests</a></li>
		</th:block>
	 </ul>
</div>
<div style="margin-top:15px;"></div>
<div class="tab-content">
<div id="container-information" class="container tab-pane fade in active">
	<div class="row institution-information">
		<div class="col-md-5">
				<th:block th:if="${user.isCitizen()}">
				<div class="row form-group institution-block">
					<th:block th:if="${isEdu}">
						<div class="col-sm-4" th:if="${not #lists.isEmpty(user.childs)}">
							<button type="button" class="btn btn-sm btn-primary pull-right" data-toggle="modal" data-target="#requestModal">Make request</button>
						</div>
					</th:block>
				</div>
				</th:block>
				
				<div class="clearfix"></div>
				<th:block th:unless="${user.isEducationalRepresentative()}">
				<div class="dl-horizontal institution-info">
					<dl>
						<dt>Title</dt>
						<dd th:text="${institution.title}"></dd>
					</dl>
					<dl>
						<dt>City</dt>
						<dd th:text="${institution.city}"></dd>
					</dl>
					<dl>
						<dt>District</dt>
						<dd th:text="${institution.district}"></dd>
					</dl>
					<dl>
						<dt>Address</dt>
						<dd th:text="${institution.address}"></dd>
					</dl>
					<dl>
						<dt>Telephone</dt>
						<dd th:text="${institution.telephone}"></dd>
					</dl>
					<dl>
						<dt>Fax</dt>
						<dd th:text="${institution.fax}"></dd>
					</dl>
				</div>
				</th:block>
				<th:block th:if="${user.isEducationalRepresentative()}">
					<form method="POST" id="institution-info-form">
						<h2 class="form-heading">Edit information</h2>
						<div class="form-group">
							<input id="title" name="title" placeholder="Title" type="text" autofocus="true" class="form-control" th:attr="value=${institution.title}"/>
						</div>
						<div class="form-group">
							<input id="city" name="city" placeholder="City" type="text" autofocus="true" class="form-control" th:attr="value=${institution.city}"/>
						</div>
						<div class="form-group">
							<input id="district" name="district" placeholder="District" type="text" autofocus="true" class="form-control" th:attr="value=${institution.district}"/>
						</div>
						<div class="form-group">
							<input id="address" name="address" placeholder="Address" type="text" autofocus="true" class="form-control" th:attr="value=${institution.address}"/>
						</div>
						<div class="form-group">
							<input id="telephone" name="telephone" placeholder="Telephone" type="text" autofocus="true" class="form-control" th:attr="value=${institution.telephone}"/>
						</div>
						<div class="form-group">
							<input id="fax" name="fax" placeholder="Fax" type="text" autofocus="true" class="form-control" th:attr="value=${institution.fax}"/>
						</div>
						<button class="btn btn-sm btn-primary btn-block" type="button" onclick="saveInformation();">Save</button>
						<div class="alert alert-success px-2" style="display:none;" id="success-info">Changes are saved!</div>
						<div class="alert alert-danger px-2" style="display:none" id="error-info">Error occured during saving information about institution. All fields must be filled! Please, refresh page and try later.</div>
						<div class="alert alert-danger px-2" style="display:none" id="error-info-empty">You must fill all fields!</div>
					</form>
				</th:block>
		</div>
		<th:block th:if="${isEdu}">
		<div class="col-md-7">
			<h2 class="form-heading">Seats</h2>
			<th:block th:if="${user.isEducationalRepresentative()}">
			<div class="row form-add-seats">
				<form method="POST" class="form-horizontal" id="form-add-seats">
						<div class="form-group">
							<div class="col-sm-4">
								<label for="classNumber">Class number:</label>
								<input id="classNumber" name="classNumber" placeholder="Class number" type="text" class="form-control" maxlength="2" />
							</div>       
							<div class="col-sm-4">
								<label for="totalSeats">Total seats:</label>
								<input id="totalSeats" name="totalSeats" placeholder="Total seats" type="text" class="form-control" maxlength="3" />
							</div>
							<div class="col-sm-3">
								<label for="busySeats">Busy seats:</label>
								<input id="busySeats" name="busySeats" placeholder="Busy seats:" type="text" class="form-control" maxlength="3" />
							</div>
							<div class="col-sm-1">
								<button class="btn btn-sm btn-primary" type="button" onclick="saveSeatsInfo();">Add</button>
							</div>
						</div>
						<div>
							<div class="alert alert-success px-2" style="display:none;" id="success-seats">Changes are saved!</div>
							<div class="alert alert-danger px-2" style="display:none" id="error-seats">Error occured during saving seats information. May be you enter invalid parameters? Please, refresh page and try later.</div>
							<div class="alert alert-danger px-2" style="display:none" id="error-seats-empty">You must fill all fields!</div>
						</div>
				</form>
			</div>
			</th:block>
			<div class="table-seats" id="table-seats">
				<table class="table table-fixed">
					<thead>
						<tr>
							<th class="col-xs-3">Class</th>
							<th class="col-xs-4">Total seats</th>
							<th class="col-xs-4">Free seats</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
					<th:block th:each="s : ${institution.listSeats}">
						<tr th:attr="id=${'el-class-number-' + s.classNumber}">
							<td class="col-xs-3" th:text="${s.classNumber}"></td>
							<td class="col-xs-4" th:text="${s.seats}"></td>
							<td class="col-xs-4" th:text="${s.seats - s.busySeats}"></td>
							<td>
								<!-- remove not described in system! -->
								<!--
								<th:block th:if="${user.isEducationalRepresentative()}">
									<a class="btn btn-sm btn-primary" onclick="removeSeatsInfo(this);">
										<span class="glyphicon glyphicon-remove"></span>
										<input name="classNumber" type="hidden" th:attr="value=${s.id.classNumber}" />
										<input name="id" type="hidden" th:attr="value=${institution.id}" />
									</a>
								</th:block>
								-->
							</td>
				  		</tr>
					</th:block>
					</tbody>
				</table>
			</div>
		</div>
		</th:block>
	</div>
	<hr></hr>
	<div class="row feedbacks">
			<h2 class="form-signin-heading text-center">Feedbacks</h2>
			<div class="row">
				<a class="btn btn-sm btn-primary pull-right" data-toggle="modal" data-target="#feedbackModal" onclick="saveToUserId(this);">Add feedback</a>
			</div>
			
			<div>
				<table class="table table-fixed" id="table-feedbacks">
					<thead>
						<tr>
							<th class="col-xs-1">Date</th>
							<th class="col-xs-2">User</th>
							<th class="col-xs-2">To user</th>
							<th class="col-xs-6">Text</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
					<th:block th:each="f : ${institution.feedbacks}">
						<tr>
							<td class="col-xs-1" th:text="${#dates.format(f.date,'yyyy-MM-dd HH:mm')}"></td>
							<td class="col-xs-2" th:text="${f.user.fullName}"></td>
							<td class="col-xs-2" th:if="${f.toUser}" th:text="${f.toUser.fullName}"></td>
							<td class="col-xs-2" th:unless="${f.toUser}"></td>
							<td class="col-xs-6" th:text="${f.text}"></td>
							<td>
								<th:block th:if="${f.user.username != user.username}">
									<a class="btn btn-sm btn-primary" data-toggle="modal" data-target="#feedbackModal" onclick="saveToUserId(this);">Add feedback</a>
									<input name="toUserId" type="hidden" th:attr="value=${f.user.id}" />
									<input name="toUserName" type="hidden" th:attr="value=${f.user.fullName}" />
								</th:block>
							</td>
						</tr>
					</th:block>
					</tbody>
				</table>
		</div>
	</div>
</div>
<th:block th:unless="${isEdu}">
<div id="container-doctors" class="container tab-pane fade">
	<h2 class="form-heading text-center">Doctors</h2>
	<div class="row form-group institution-block">
		<th:block th:if="${user.isMedicalRepresentative()}">
		<div class="col-sm-12">
			<button type="button" class="btn btn-sm btn-primary pull-right" data-toggle="modal" data-target="#doctorModal">Add doctor</button>
		</div>
		</th:block>
	</div>
	<th:block th:if="${user.isMedicalRepresentative()}">
	</th:block>
	<hr></hr>
	<div class="row table-doctors" id="table-doctors">
		<div>
			<table class="table table-fixed">
				<thead>
					<tr>
						<th class="col-xs-3">Full name</th>
						<th class="col-xs-2">Email</th>
						<th class="col-xs-3">Position</th>
						<th class="col-xs-3">Summary</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
				<th:block th:each="doctor : ${institution.doctors}">
					<tr>
						<td class="col-xs-3" th:text="${doctor.fullName}"></td>
						<td class="col-xs-2" th:text="${doctor.email}">Email</td>
						<td class="col-xs-3" th:text="${doctor.position}">Position</td>
						<td class="col-xs-3" th:text="${doctor.summary}">Summary</td>
						<td>
							<th:block th:if="${user.isMedicalRepresentative()}">
							<a class="btn btn-sm btn-primary" onclick="removeDoctor(this);">
								<span class="glyphicon glyphicon-remove"></span>
							</a>
							<a class="btn btn-sm btn-primary" data-toggle="modal" data-target="#addTicketsModal" onclick="saveDoctorId(this);">Add tickets</a>
							<a class="btn btn-sm btn-primary" data-toggle="modal" data-target="#addTicketModal" onclick="saveDoctorId(this);">Add ticket</a>
							<input name="id" type="hidden" th:attr="value=${doctor.id}" />
							</th:block>
						</td>
					</tr>
				</th:block>
				</tbody>
			</table>
		</div>
	</div>
</div>
<div id="container-tickets" class="container tab-pane fade">
	<h2 class="form-heading text-center">Tickets</h2>
	<div class="row form-group institution-block">
		<div class="col-sm-4">
			<span>Select doctor:</span>
			<select id="select-doctor-tickets" class="form-control">
				<option value="0">-Select doctor-</option>
				<th:block th:each="doctor : ${institution.doctors}">
					<option th:attr="value=${doctor.id}" th:text="${doctor.fullName + ' (' + doctor.position + ')'}"></option>
				</th:block>
			</select>
		</div>
		<th:block th:if="${user.isMedicalRepresentative()}">
		<div class="col-sm-4" th:if="${not #lists.isEmpty(institution.doctors)}">
			<button type="button" class="btn btn-sm btn-primary pull-right" data-toggle="modal" data-target="#removeTicketsModal">Remove tickets</button>
		</div>
		</th:block>
	</div>
	<hr></hr>
	<div class="row table-tickets">
		<div>
			<table class="table table-fixed" id="table-tickets">
				<thead>
					<tr>
						<th class="col-xs-1">Date</th>
						<th class="col-xs-2">Doctor</th>
						<th class="col-xs-2">Citizen</th>
						<th class="col-xs-2">Child</th>
						<th class="col-xs-1">Visited</th>
						<th class="col-xs-2">Summary</th>
						<th></th>
					</tr>
				</thead>
					<tbody>
					<th:block th:each="ticket : ${institution.tickets}">
						<tr th:attr="id=${'el-ticket-' + ticket.id},class=${'ticket-for-doctor-' + ticket.doctor.id +
							' ticket-for-date-' + #dates.format(ticket.date,'yyyy-MM-dd')}">
							<td class="col-xs-1" th:text="${#dates.format(ticket.date,'yyyy-MM-dd HH:mm')}"></td>
							<td class="col-xs-2" th:text="${ticket.doctor.fullName}"></td>
							<td class="col-xs-2" th:if="${ticket.user}" th:text="${ticket.user.fullName}"></td>
							<td class="col-xs-2" th:unless="${ticket.user}"></td>
							<td class="col-xs-2" th:if="${ticket.child}" th:text="${ticket.child.fullName}"></td>
							<td class="col-xs-2" th:unless="${ticket.child}"></td>
							<td class="col-xs-1" th:if="${ticket.visited}">yes</td>
							<td class="col-xs-1" th:unless="${ticket.visited}">no</td>
							<td class="col-xs-2" th:text="${ticket.summary}"></td>
							<td>
								<th:block th:if="${user.isCitizen() and ticket.canBeRefused()}">
									<th:block th:if="${ticket.user}">
										<th:block th:if="${ticket.user.id == user.id}">
											<a class="btn btn-sm btn-primary" id="btn-refuse" onclick="refuseTicket(this);">
												<span class="glyphicon glyphicon-remove">&nbsp;Refuse</span>
											</a>
										</th:block>
									</th:block>
									<th:block th:unless="${ticket.user}">
										<th:block th:unless="${ticket.visited}">
											<th:block th:if="${#lists.isEmpty(user.childs)}">
												<a class="btn btn-sm btn-primary" id="btn-take" onclick="takeTicket(this);">Take</a>
											</th:block>
											<th:block th:if="${not #lists.isEmpty(user.childs)}">
												<a class="btn btn-sm btn-primary" id="btn-take" onclick="saveTicketId(this);" data-toggle="modal" data-target="#takeTicketModal">
													<span class="glyphicon glyphicon-remove">&nbsp;Take</span>
												</a>
											</th:block>
										</th:block>
									</th:block>
								</th:block>
								<th:block th:if="${user.isMedicalRepresentative() and ticket.canBeRefused()}">
									<a class="btn btn-sm btn-primary" onclick="removeTicket(this);">
										<span class="glyphicon glyphicon-remove"></span>
									</a>
								</th:block>
								<th:block th:if="${user.isMedicalRepresentative() and ticket.canSetVisited()}">
									<a class="btn btn-sm btn-primary" id="btn-set-visited" data-toggle="modal" data-target="#setVisitedModal" onclick="saveTicketId(this);">
										<span class="glyphicon glyphicon-ok-sign">&nbsp;Set visited</span>
									</a>
								</th:block>
								<input name="id" type="hidden" th:attr="value=${ticket.id}"/>
							</td>
						</tr>
					</th:block>
					</tbody>
			</table>
		</div>
	</div>
</div>
</th:block>
<th:block th:if="${isEdu}">
<th:block th:if="${user.isEducationalRepresentative()}">
<div id="container-requests" class="container tab-pane fade">
	<h2 class="form-heading text-center">Educational requests</h2>
	<div class="row table-request" id="table-requests">
		<div>
			<table class="table table-fixed">
				<thead>
					<tr>
						<th class="col-xs-1">Date</th>
						<th class="col-xs-2">Appoinment</th>
						<th class="col-xs-2">Status</th>
						<th class="col-xs-2">Child</th>
						<th class="col-xs-1">Class</th>
						<th class="col-xs-2">Birth date</th>
						<th></th>
					</tr>
				</thead>
					<tbody>
					<th:block th:each="request : ${institution.eduRequests}">
						<tr th:attr="id=${'el-request-' + request.id}">
							<td class="col-xs-1" th:text="${#dates.format(request.creationDate,'yyyy-MM-dd')}">Date</td>
							<td class="col-xs-2" th:if="${request.appointment}" th:text="${#dates.format(request.appointment,'yyyy-MM-dd HH:mm')}"></td>
							<td class="col-xs-2" th:unless="${request.appointment}"></td>
							<td class="col-xs-2" th:text="${request.status.getBeautifulText()}">Status</td>
							<td class="col-xs-2" th:text="${request.child.fullName}"></td>
							<td class="col-xs-1" th:text="${request.classNumber}">Class</td>
							<td class="col-xs-2" th:text="${#dates.format(request.child.birthDate,'yyyy-MM-dd')}">Birth date</td>
							<td>
								<th:block th:if="${request.status == T(portal.model.entities.EduRequest.Status).OPENED}">
									<a class="btn btn-sm btn-primary" onclick="acceptRequest(this);">Accept</a>
								</th:block>
								<th:block th:if="${request.appointment}">
									<th:block th:if="${request.passedAppointment}">
										<th:block th:unless="${request.closed}">
											<a class="btn btn-sm btn-primary" onclick="refuseRequest(this);">Refuse</a>
											<a class="btn btn-sm btn-primary" onclick="enrollRequest(this);">Enroll</a>
										</th:block>
									</th:block>
								</th:block>
								<th:block th:unless="${request.appointment}">
									<th:block th:if="${request.status == T(portal.model.entities.EduRequest.Status).ACCEPTED_BY_PARENT}">
										<a class="btn btn-sm btn-primary" onclick="saveRequestId(this);" data-toggle="modal" data-target="#appointmentModal" >Make appointment</a>
									</th:block>
								</th:block>
								<input name="id" type="hidden" th:attr="value=${request.id}" />
							</td>
						</tr>
					</th:block>
					</tbody>
			</table>
		</div>
	</div>
</div>
</th:block>
</th:block>
</div>
	<!-- Modal -->
	<div id="addTicketsModal" class="modal fade" role="dialog">
		<div class="modal-dialog">
			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" onclick="modalAddTicketsClean();">&times;</button>
					<h4 class="modal-title">Add tickets (date format - 2017-06-26 17:45)</h4>
				</div>
				<div class="modal-body">
					<div class="form-group row">
							<div class="col-sm-4">
								<label for="startDate">Start date:</label>
								<input id="startDate" name="startDate" placeholder="Start date" type="text" class="form-control" maxlength="16" />
							</div>       
							<div class="col-sm-4">
								<label for="endDate">End date:</label>
								<input id="endDate" name="endDate" placeholder="End date" type="text" class="form-control" maxlength="16" />
							</div>
							<div class="col-sm-4">
								<label for="interval">Interval in minutes:</label>
								<input id="interval" name="interval" placeholder="Interval in minutes:" type="text" class="form-control" maxlength="3" />
							</div>
					</div>
					<div class="alert alert-success px-2" style="display:none" id="success-add-tickets">Tickets successfully added!</div>
					<div class="alert alert-danger px-2" style="display:none" id="error-add-tickets-empty">You must fill all fields!</div>
					<div class="alert alert-danger px-2" style="display:none" id="error-add-tickets">Error occured during adding tickets. Please, check correctness of data or refresh page and try later.</div>
				</div>
				<div class="modal-footer">
					<a class="btn btn-sm btn-primary pull-right" onclick="addTickets();">Add tickets</a>
					<button type="button" class="btn btn-sm btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove" onclick="modalAddTicketsClean();"></span>&nbsp;Close</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Modal -->
	<div id="addTicketModal" class="modal fade" role="dialog">
		<div class="modal-dialog">
			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" onclick="modalAddTicketClean();">&times;</button>
					<h4 class="modal-title">Add ticket (date format - 2017-06-26 17:45)</h4>
				</div>
				<div class="modal-body">
					<div class="form-group row">
							<div class="col-sm-12">
								<label for="ticketDate">Ticket date:</label>
								<input id="ticketDate" name="ticketDate" placeholder="Ticket date" type="text" class="form-control" maxlength="16" />
							</div>       
					</div>
					<div class="alert alert-success px-2" style="display:none" id="success-add-ticket">Ticket successfully added!</div>
					<div class="alert alert-danger px-2" style="display:none" id="error-add-ticket-empty">You must fill all fields!</div>
					<div class="alert alert-danger px-2" style="display:none" id="error-add-ticket">Error occured during adding ticket. Please, check correctness of data or refresh page and try later.</div>
				</div>
				<div class="modal-footer">
					<a class="btn btn-sm btn-primary pull-right" onclick="addTicket();">Add ticket</a>
					<button type="button" class="btn btn-sm btn-default" data-dismiss="modal" onclick="modalAddTicketClean();"><span class="glyphicon glyphicon-remove"></span>&nbsp;Close</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Modal -->
	<div id="removeTicketsModal" class="modal fade" role="dialog" th:if="${user.isMedicalRepresentative()}">
		<div class="modal-dialog">
			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Remove tickets (date format - 2017-06-26)</h4>
				</div>
				<div class="modal-body">
					<div class="form-group row">
						<div class="col-sm-12">
							<span>Select doctor:</span>
							<select id="removeTicketsDoctor" class="form-control">
								<th:block th:each="d : ${institution.doctors}">
									<option th:text="${d.fullName + '(' + d.position + ')'}" th:attr="value=${d.id}"></option>
								</th:block>
							</select>
						</div>
						<div class="col-sm-12">
							<label for="removeTicketDate">Date (for all leave blank):</label>
							<input id="removeTicketDate" name="removeTicketDate" placeholder="Date" type="text" class="form-control" maxlength="10" />
						</div>       
					</div>
					<div class="alert alert-success px-2" style="display:none" id="success-remove-tickets">Ticket successfully removed!</div>
					<div class="alert alert-danger px-2" style="display:none" id="error-remove-tickets">Error occured during removing tickets. Please, check correctness of data or refresh page and try later.</div>
				</div>
				<div class="modal-footer">
					<a class="btn btn-sm btn-primary pull-right" onclick="removeTickets();">Remove tickets</a>
					<button type="button" class="btn btn-sm btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>&nbsp;Close</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Modal -->
	<div id="doctorModal" class="modal fade" role="dialog" th:if="${user.isMedicalRepresentative()}">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Add doctor</h4>
				</div>
				<div class="modal-body">
					<div>
					<form method="POST">
						<div class="form-group">
							<input id="username" name="username" placeholder="User name" type="text" autofocus="true" class="form-control"/>
						</div>

						<div class="form-group">
							<input id="password" name="password" placeholder="Password" type="password" class="form-control" />
						</div>

						<div th:class="form-group">
							<input id="passwordConfirm" name="passwordConfirm" placeholder="Confirm password" type="password" class="form-control" />
						</div>

						<div th:class="form-group">
							<input id="fullName" name="fullName" placeholder="Full name" type="text" class="form-control" />
						</div>

						<div th:class="form-group">
							<input id="email" name="email" placeholder="Email" type="text" class="form-control" />
						</div>
						
						<div class="form-group">
							<input id="position" name="position"  placeholder="Position" type="text" class="form-control" />
						</div>
						
						<div th:class="form-group">
							<input id="summary" name="summary" placeholder="Summary" type="text" class="form-control" />
						</div>
					</form>
						<div class="alert alert-success px-2" style="display:none" id="success-add-doctor">Doctor successfully saved!</div>
						<div class="alert alert-danger px-2" style="display:none" id="error-add-doctor-invalid">You must fill all fields! Also password and it confirm must be equal!</div>
					<div class="alert alert-danger px-2" style="display:none" id="error-add-doctor">Error occurred during adding doctor. May be user with this username already exists or you enter invalid email! Please, refresh page and try later.</div>
					</div>
				</div>
				<div class="modal-footer">
					<a class="btn btn-sm btn-primary pull-right" onclick="addDoctor();">Add doctor</a>
					<button type="button" class="btn btn-sm btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>&nbsp;Close</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Modal -->
	<div id="feedbackModal" class="modal fade" role="dialog">
				<div class="modal-dialog">
					<!-- Modal content-->
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" onlick="modalFeedbackClean();">&times;</button>
								<h4 class="modal-title">Add feedback</h4>
						</div>
						<div class="modal-body">
							<div class="form-group">
								<div class="row">
									<div class="col-sm-12">
										<input name="new-feedback-text" type="text" class="form-control" />
									</div>
								</div>
							</div>
							<div>
								<div class="alert alert-success px-2" style="display:none;" id="success-feedback">Feedback successfully saved!</div>
								<div class="alert alert-danger px-2" style="display:none;" id="error-feedback">Error occurred during saving feedback. Please, check that text not empty or refresh page and try later.</div>
							</div>
						</div>
						<div class="modal-footer">
							<a class="btn btn-sm btn-primary pull-right" onclick="saveFeedback();">Save</a>
							<button type="button" class="btn btn-sm btn-default" data-dismiss="modal" onlick="modalFeedbackClean();"><span class="glyphicon glyphicon-remove"></span>&nbsp;Close</button>
						</div>
					</div>
				</div>
	</div>
	<!-- Modal -->
	<div id="setVisitedModal" class="modal fade" role="dialog">
		<div class="modal-dialog">
			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Enter visit summary</h4>
				</div>
				<div class="modal-body">
					<div class="form-group">
						<div class="row">
							<div class="col-sm-12">
								<input name="summary-text" type="text" class="form-control" />
							</div>
						</div>
					</div>
					<div>
						<div class="alert alert-success px-2" style="display:none;" id="success-summary">Summary successfully saved!</div>
						<div class="alert alert-danger px-2" style="display:none;" id="error-summary">Error occurred during saving status and summary. Please, check that summary not empty or refresh page and try later.</div>
					</div>
				</div>
				<div class="modal-footer">
					<a class="btn btn-sm btn-primary pull-right" onclick="saveSetVisited();">Save</a>
					<button type="button" class="btn btn-sm btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>&nbsp;Close</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Modal -->
	<div id="appointmentModal" class="modal fade" role="dialog">
		<div class="modal-dialog">
			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" onclick="modalAppointmentClean();">&times;</button>
					<h4 class="modal-title">Make appointment (date format - 2017-10-12 10:00)</h4>
				</div>
				<div class="modal-body">
					<div class="form-group">
						<div class="row">
							<div class="col-sm-12">
								<input name="appointment-date" type="text" class="form-control" />
							</div>
						</div>
					</div>
					<div>
						<div class="alert alert-success px-2" style="display:none;" id="success-appointment">Appointment successfully saved!</div>
						<div class="alert alert-danger px-2" style="display:none;" id="error-appointment">Error occurred during saving appointment. Please, check that date is valid or refresh page and try later.</div>
					</div>
				</div>
				<div class="modal-footer">
					<a class="btn btn-sm btn-primary pull-right" onclick="makeAppointment(this);">Save</a>
					<button type="button" class="btn btn-sm btn-default" data-dismiss="modal" onclick="modalAppointmentClean();"><span class="glyphicon glyphicon-remove"></span>&nbsp;Close</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Modal -->
	<th:block th:if="${isEdu}">
	<div id="requestModal" class="modal fade" role="dialog" th:if="${user.isCitizen()}">
					<div class="modal-dialog">
						<!-- Modal content-->
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal">&times;</button>
									<h4 class="modal-title">Add educational request</h4>
							</div>
							<div class="modal-body">
								<div class="form-group">
									<div class="row">
										<div class="col-sm-12">
											<span>Select child:</span>
											<select id="request-child" class="form-control">
												<th:block th:each="child : ${user.childs.values()}">
													<option th:text="${child.fullName + '(' + child.birthCertificate + ')'}" th:attr="value=${child.id}"></option>
												</th:block>
											</select>
										</div>
										<div class="col-sm-12">
											<span>Select class:</span>
											<select id="request-class" class="form-control">
												<th:block th:each="s : ${institution.listSeats}">
													<option th:text="${s.classNumber}" th:attr="value=${s.classNumber}"></option>
												</th:block>
											</select>
										</div>
									</div>
								</div>
								<div>
									<div class="alert alert-success px-2" style="display:none" id="success-request">Request successfully saved!</div>
									<div class="alert alert-danger px-2" style="display:none" id="error-request">Error occured during saving educational request. May be all seats in class are busy! Or request in institution already exists or child already enrolled in some institution! Child can be enrolled just in one institution! Please, select options or refresh page and try later.</div>
								</div>
							</div>
							<div class="modal-footer">
								<a class="btn btn-sm btn-primary pull-right" onclick="addEducationalRequest();">Make request</a>
								<button type="button" class="btn btn-sm btn-default" data-dismiss="modal" obclick="jQuery('#success-request').hide();jQuery('#error-request').hide();"><span class="glyphicon glyphicon-remove"></span>&nbsp;Close</button>
							</div>
						</div>
					</div>
	</div>
	</th:block>

<!-- Modal -->
<div id="takeTicketModal" class="modal fade" role="dialog" th:if="${user.isCitizen()}">
	<div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" obclick="jQuery('#success-take-ticket').hide();jQuery('#error-take-ticket').hide();">&times;</button>
				<h4 class="modal-title">Take ticket</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<div class="row">
						<div class="col-sm-12">
							<span>Select child or yourself:</span>
							<select id="take-ticket-child" class="form-control">
								<option th:text="${'me (' + user.fullName + ')'}" value="0" selected="selected"></option>
								<th:block th:each="child : ${user.childs.values()}">
									<option th:text="${child.fullName}" th:attr="value=${child.id}"></option>
								</th:block>
							</select>
						</div>
					</div>
				</div>
				<div>
					<div class="alert alert-success px-2" style="display:none" id="success-take-ticket">Ticket successfully taken!</div>
					<div class="alert alert-danger px-2" style="display:none" id="error-take-ticket">Error occurred during taking ticket. Please, refresh page and try later.</div>
				</div>
			</div>
			<div class="modal-footer">
				<a class="btn btn-sm btn-primary pull-right" onclick="takeTicket(this);">Take ticket</a>
				<button type="button" class="btn btn-sm btn-default" data-dismiss="modal" obclick="jQuery('#success-take-ticket').hide();jQuery('#error-take-ticket').hide();"><span class="glyphicon glyphicon-remove"></span>&nbsp;Close</button>
			</div>
		</div>
	</div>
</div>
			<!--
			<form method="POST" class="form-signin" action="#" th:action="@{/profile/update}" th:object="${userForm}">
				<h2 class="form-heading">Edit information</h2>
				<div class="form-group">
					<input id="title" name="title" placeholder="Title" type="text" autofocus="true" class="form-control" th:attr="value=${institution.title}"/>
				</div>
				<div class="form-group">
					<input id="city" name="city" placeholder="City" type="text" autofocus="true" class="form-control" th:attr="value=${institution.city}"/>
				</div>
				<div class="form-group">
					<input id="district" name="district" placeholder="District" type="text" autofocus="true" class="form-control" th:attr="value=${institution.district}"/>
				</div>
				<div class="form-group">
					<input id="address" name="address" placeholder="Address" type="text" autofocus="true" class="form-control" th:attr="value=${institution.address}"/>
				</div>
				<div class="form-group">
					<input id="telephone" name="telephone" placeholder="Telephone" type="text" autofocus="true" class="form-control" th:attr="value=${institution.telephone}"/>
				</div>
				<div class="form-group">
					<input id="fax" name="fax" placeholder="Fax" type="text" autofocus="true" class="form-control" th:attr="value=${institution.fax}"/>
				</div>
				<button class="btn btn-sm btn-primary btn-block" type="button" onclick="saveInformation();">Save</button>
				<div class="alert alert-success px-2" style="display:none;" id="success-seats">Changes are saved!</div>
				<div class="alert alert-danger px-2" style="display:none" id="error-seats">Error occured during saving seats information. Please, refresh page and try later.</div>
			</form>
			-->
</body>
</html>